  전체 흐름

  1. 데이터 입력

  사용자가 "회사 워크샵을 다음 주 금요일 오후 2시에 강남 회의실에서 진행합니다. 참석
  부탁드립니다."라는 메시지를 보냈다고 가정하겠습니다.

  2. 유사 템플릿 검색

  - ChromaDB에서 이 메시지와 유사한 기존 템플릿들을 벡터 검색합니다
  - 유사도 점수(0.7 이상)가 높은 템플릿들을 찾아서 참고용으로 가져옵니다
  - 예: "서비스 소개서 발송" 템플릿과 0.6 유사도로 매칭될 수 있습니다

  3. 카테고리 분석

  - 메시지에서 "워크샵", "진행", "참석"같은 키워드를 분석합니다
  - 화이트리스트 패턴과 매칭해서 어떤 카테고리에 속하는지 판단합니다
  - 이 경우 "예약/신청" 카테고리로 분류될 가능성이 높습니다

  4. 화이트리스트 검증

  - 하드코딩된 화이트리스트 키워드들과 비교합니다
  - "예약", "진행", "안내" 같은 허용된 키워드들이 있는지 확인합니다
  - 매칭된 키워드들을 점수로 환산합니다

  5. 블랙리스트 검증

  - 금지된 키워드들("특가", "할인", "이벤트", "생일축하" 등)이 있는지 검사합니다
  - 마케팅성 표현("지금 구매", "서둘러" 등)이 있는지 확인합니다
  - 이 예시 메시지에는 블랙리스트 위반이 없을 것입니다

  6. 특수 규칙 검사

  - 변수(#{이름})만으로만 구성되었는지 확인
  - 광고성 URL이 포함되어 있는지 확인
  - 긴급성 유도 표현("지금", "서둘러")이 있는지 확인

  7. 최종 결과 생성

  {
    "is_valid": true,
    "score": 85,
    "whitelist_matches": ["예약", "진행", "안내"],
    "blacklist_violations": [],
    "whitelist_categories": ["예약/신청"],
    "recommendations": [
      "적합한 알림톡 템플릿입니다",
      "예약/신청 카테고리에 적합합니다"
    ]
  }

  8. 응답 반환

  - 검증 결과와 함께 유사한 참고 템플릿 정보도 함께 보냅니다
  - 점수가 높으면 승인 추천, 낮으면 수정 권장사항을 제공합니다
  - 위반 사항이 있으면 구체적으로 어떤 부분을 수정해야 하는지 알려줍니다

  이렇게 해서 사용자는 자신의 메시지가 카카오 알림톡 규정에 맞는지, 어떤 카테고리에 속하는지, 수정할
   부분이 있는지를 바로 알 수 있습니다.
